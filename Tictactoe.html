<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body{
margin:0;
background:#111;
color:white;
font-family:Arial;
display:flex;
flex-direction:column;
align-items:center;
justify-content:center;
height:100vh;
}

#board{
display:grid;
grid-template-columns:repeat(3,100px);
gap:5px;
margin-top:15px;
}

.cell{
width:100px;
height:100px;
background:#222;
font-size:60px;
display:flex;
justify-content:center;
align-items:center;
cursor:pointer;
}

select,button{
margin-top:10px;
padding:8px;
font-size:16px;
}
</style>
</head>

<body>

<h2 id="status">Giliran Kamu (X)</h2>

<select id="difficulty">
<option value="easy">Easy</option>
<option value="medium">Medium</option>
<option value="hard">Hard</option>
</select>

<div id="board"></div>

<button onclick="resetGame()">Restart</button>

<script>
const boardEl=document.getElementById("board");
const statusText=document.getElementById("status");
const difficultyEl=document.getElementById("difficulty");

let board=["","","","","","","","",""];
let gameActive=true;

const HUMAN="X";
const AI="O";

// buat grid
for(let i=0;i<9;i++){
let cell=document.createElement("div");
cell.classList.add("cell");
cell.dataset.index=i;
cell.addEventListener("click",playerMove);
boardEl.appendChild(cell);
}

function playerMove(e){
if(!gameActive)return;

let i=e.target.dataset.index;
if(board[i]!="")return;

makeMove(i,HUMAN);

if(!gameActive)return;

setTimeout(aiMove,300);
}

function makeMove(i,player){
board[i]=player;
document.querySelectorAll(".cell")[i].textContent=player;

if(checkWinner(board,player)){
statusText.textContent=(player==HUMAN?"Kamu Menang!":"AI Menang!");
gameActive=false;
return;
}

if(board.every(c=>c!="")){
statusText.textContent="Seri!";
gameActive=false;
return;
}

statusText.textContent=(player==HUMAN?"Giliran AI":"Giliran Kamu");
}

// ================= AI =================

function aiMove(){

let diff=difficultyEl.value;
let move;

if(diff=="easy"){
move=randomMove();
}
else if(diff=="medium"){
move=Math.random()<0.5?randomMove():bestMove();
}
else{
move=bestMove();
}

makeMove(move,AI);
}

function randomMove(){
let empty=board
.map((v,i)=>v==""?i:null)
.filter(v=>v!=null);

return empty[Math.floor(Math.random()*empty.length)];
}

// MINIMAX (AI pintar)
function bestMove(){
let bestScore=-Infinity;
let move;

for(let i=0;i<9;i++){
if(board[i]==""){
board[i]=AI;
let score=minimax(board,false);
board[i]="";
if(score>bestScore){
bestScore=score;
move=i;
}
}
}
return move;
}

function minimax(newBoard,isMax){

if(checkWinner(newBoard,AI)) return 1;
if(checkWinner(newBoard,HUMAN)) return -1;
if(newBoard.every(c=>c!="")) return 0;

if(isMax){
let best=-Infinity;
for(let i=0;i<9;i++){
if(newBoard[i]==""){
newBoard[i]=AI;
best=Math.max(best,minimax(newBoard,false));
newBoard[i]="";
}
}
return best;
}else{
let best=Infinity;
for(let i=0;i<9;i++){
if(newBoard[i]==""){
newBoard[i]=HUMAN;
best=Math.min(best,minimax(newBoard,true));
newBoard[i]="";
}
}
return best;
}
}

// cek menang
function checkWinner(b,p){
const win=[
[0,1,2],[3,4,5],[6,7,8],
[0,3,6],[1,4,7],[2,5,8],
[0,4,8],[2,4,6]
];

return win.some(([a,b2,c])=>
b[a]==p && b[b2]==p && b[c]==p);
}

function resetGame(){
board=["","","","","","","","",""];
gameActive=true;
statusText.textContent="Giliran Kamu (X)";
document.querySelectorAll(".cell")
.forEach(c=>c.textContent="");
}
</script>

</body>
</html>
